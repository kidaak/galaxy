{"version":3,"file":"workflow-manager.js","sources":["../../../src/mvc/workflow/workflow-manager.js"],"names":["define","Connector","Toastr","Workflow","app","canvas_container","this","id_counter","nodes","name","has_changes","active_form_has_changes","nodeLabels","$","extend","prototype","canLabelNodeWith","label","registerNodeLabel","unregisterNodeLabel","updateNodeLabel","fromLabel","toLabel","warning","attemptUpdateNodeLabel","node","setLabel","create_node","type","title_text","content_id","prebuildNode","add_node","fit_canvas_to_nodes","canvas_manager","draw_overview","activate_node","id","element","attr","workflow","remove_node","active_node","clear_active_node","remove_all","wf","each","k","v","destroy","rectify_workflow_outputs","using_workflow_outputs","has_existing_pjas","workflow_outputs","length","post_job_actions","pja_id","pja","action_type","self","node_changed","pjas_to_rem","push","i","pja_name","output_terminals","ot_id","ot","create_pja","isWorkflowOutput","output_name","action_arguments","reload_active_node","to_simple","input_connections","input_terminals","t","cons","connectors","c","handle1","act","node_data","tool_id","tool_state","tool_errors","position","annotation","uuid","steps","from_simple","data","max_id","step","init_field_data","css","top","left","Math","max","parseInt","isArray","l","x","other_node","connect","redraw","undefined","addWorkflowOutput","callout","find","Galaxy","root","check_changes_in_active_form","submit","make_inactive","showToolForm","form_html","make_active","force","layout","n_pred","successors","j","other","node_ids_by_level","level_parents","pred_k","sk","all_nodes","h_pad","v_pad","ids","sort","a","b","max_width","width","height","_","bounds_for_all_nodes","p","xmin","xmax","ymin","ymax","e","min","round_up","n","ceil","fix_delta","new_pos","bounds","parent","xmin_delta","ymin_delta","children"],"mappings":"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"}